1. Run the commands inside KSQL

CREATE STREAM NUMBERS (num INT) WITH (KAFKA_TOPIC='NUMBERS', PARTITIONS=1, VALUE_FORMAT='JSON');


2. Insert some values

INSERT INTO NUMBERS (num) VALUES (1);
INSERT INTO NUMBERS (num) VALUES (2);
INSERT INTO NUMBERS (num) VALUES (1);
INSERT INTO NUMBERS (num) VALUES (0);
INSERT INTO NUMBERS (num) VALUES (2);
INSERT INTO NUMBERS (num) VALUES (2);



3. SET 'auto.offset.reset' = 'earliest';


4. Run query

SELECT num, COUNT(num) AS cat FROM NUMBERS GROUP BY num EMIT CHANGES;

5. Create table

CREATE TABLE NUMBERS_CNT as SELECT num, COUNT(num) AS cnt FROM NUMBERS GROUP BY num EMIT CHANGES;